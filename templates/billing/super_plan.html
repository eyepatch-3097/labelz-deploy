{% extends "base.html" %}
{% block content %}

<div class="container" style="max-width: 980px;">
  <h1 class="h4 mb-3">Plans & Usage</h1>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <div class="text-muted small">Current plan</div>
          <div class="h5 mb-0">{{ plan_code }}</div>
        </div>
      </div>

      <hr class="my-3">

      <div class="row g-3">
        <div class="col-md-4">
          <div class="p-3 border rounded">
            <div class="text-muted small">Workspaces</div>
            <div class="fw-semibold">
              {% if ws_limit is None %}Unlimited{% else %}{{ ws_created }}/{{ ws_limit }}{% endif %}
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="p-3 border rounded">
            <div class="text-muted small">Templates</div>
            <div class="fw-semibold">
              {% if tpl_limit is None %}Unlimited{% else %}{{ tpl_created }}/{{ tpl_limit }}{% endif %}
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="p-3 border rounded">
            <div class="text-muted small">Labels</div>
            <div class="fw-semibold">
              {% if labels_limit is None %}
                Unlimited
              {% else %}
                Used: {{ labels_used }} / {{ labels_limit }} <br>
                Remaining: {{ labels_remaining }}
              {% endif %}
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>


<div class="container" style="max-width: 760px;">
  <h1 class="h4 mb-3">Super Plan Request</h1>

  {% if pending %}
    <div class="alert alert-info">
      Pending request: <b>{{ pending.requested_labels }}</b> labels.
      Submitted on {{ pending.created_at|date:"Y-m-d H:i" }}.
    </div>
  {% endif %}

  <div class="card shadow-sm">
    <div class="card-body">
      <p class="text-muted mb-3">
        Enter the number of labels you want for the next 30 days.
      </p>

      {% if not is_admin %}
        <div class="alert alert-warning mb-0">
          Only org admins can request Super plan. Please ask your admin.
        </div>
      {% else %}
        <form method="post">
          {% csrf_token %}
          <label class="form-label">Requested labels (30 days)</label>
          <input class="form-control" type="number" name="requested_labels" min="1" step="1"
                 {% if pending %}disabled{% endif %}>

          <button class="btn btn-primary mt-3" {% if pending %}disabled{% endif %}>
            Request Super
          </button>
        </form>
      {% endif %}

    </div>
  </div>
</div>

{% endblock %}
