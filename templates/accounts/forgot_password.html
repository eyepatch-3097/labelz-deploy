{% extends "base.html" %}
{% block content %}
<div class="container" style="max-width:560px;">
  <h1 class="h5 mb-2">Forgot Password</h1>

  {% if step == "otp" %}
    <p class="text-muted">We sent an OTP to <b>{{ email }}</b>. Enter it to confirm password reset.</p>

    <form method="post" class="card shadow-sm">
      {% csrf_token %}
      <input type="hidden" name="action" value="confirm_reset">
      <div class="card-body">
        <label class="form-label">OTP</label>
        <input class="form-control" name="otp" maxlength="6" inputmode="numeric" required>
        <button class="btn btn-primary mt-3 w-100">Confirm Reset</button>

        <div class="text-muted small mt-3">
          Didn’t receive it? Go back and send again.
        </div>
      </div>
    </form>

    <a class="btn btn-link mt-2 p-0" href="{% url 'forgot_password' %}">Start over</a>

  {% else %}
    <p class="text-muted">Enter your email and new password. We’ll send an OTP to confirm.</p>

    <form method="post" class="card shadow-sm">
      {% csrf_token %}
      <input type="hidden" name="action" value="send_otp">
      <div class="card-body">
        <label class="form-label">Email</label>
        <input class="form-control" name="email" value="{{ email|default:'' }}" required>

        <label class="form-label mt-3">New password</label>
        <input class="form-control" name="password1" type="password" required>

        <label class="form-label mt-3">Confirm password</label>
        <input class="form-control" name="password2" type="password" required>

        <button class="btn btn-dark mt-3 w-100">Send OTP</button>
      </div>
    </form>
  {% endif %}
</div>
{% endblock %}